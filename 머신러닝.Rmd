---
title: "머신러닝"
author: "곽명빈"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(dplyr)
library(stringr)
library(tidyr)
library(tidyverse)
library(lubridate)
library(knitr)
library(ggplot2)
library(TTR)
library(forecast)
library(rio)
library(vars)
library(tsDyn)

```
### 데이터 불러오기
```{r}
garlic_production <- read.csv('garlic_production.csv')
```


### 시계열 분석(벡터자기회귀모형)

```{r}
garlic_production_ts <- ts(garlic_production)  # 시계열 데이터로 변환

str(garlic_production)

select <- dplyr::select

garlic_production_ts <- ts(garlic_production %>% 
              select(도매가격.원.kg.,월합강수량평균.y,X1월.평균기온,거래금액.백만원.),
              start = c(2014, 01),
              end = c(2021,12),
              frequency = 12)

head(garlic_production_ts)


VARselect(garlic_production_ts, lag.max=8,
            type="const")[["selection"]]

var1 <- VAR(garlic_production_ts, p=1, type="const")

var2 <- VAR(garlic_production_ts, p=2, type="const")
  serial.test(var2, lags.pt=10, type="PT.asymptotic")
  
var3 <- VAR(garlic_production_ts, p=3, type="const")
  serial.test(var3, lags.pt=10, type="PT.asymptotic")  
  
   forecast(var2) %>% 
    autoplot() 
```

